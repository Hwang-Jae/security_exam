<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>랜섬웨어 통합 보안 교육</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Neutral & Alert Red -->
    <!-- Application Structure Plan: A thematic, single-page application with a top navigation bar (Home, Definition, Cases, Prevention, Quiz). This structure is chosen over a linear slide-by-slide format to allow employees to easily access the information most relevant to them (e.g., jump directly to 'Prevention' or 'Cases'). The 'Case Studies' section is designed to be highly interactive, contrasting a specific internal incident (NVH USA) with major external attacks to emphasize relevance and severity. A final 'Quiz' section reinforces learning, making the educational goal more effective and measurable. This non-linear, thematic approach is more user-friendly and engaging than a simple PowerPoint conversion. -->
    <!-- Visualization & Content Choices: 
        1. Report Info: Global Ransomware Damage (from .docx files). Goal: Show the massive financial scale. Viz/Method: Bar Chart (Chart.js). Interaction: Tooltips on hover. Justification: Clear comparison of large financial figures. Library: Chart.js (Canvas).
        2. Report Info: NVH USA Root Causes (from .pptx). Goal: List specific internal failures. Viz/Method: HTML/CSS Diagram (Flexbox cards). Interaction: None (static display). Justification: Clearer than a bulleted list. Library: HTML/Tailwind.
        3. Report Info: 3-2-1 Backup Rule (from .pptx). Goal: Explain backup strategy. Viz/Method: HTML/CSS Diagram (3 styled boxes). Interaction: None. Justification: Visual representation is memorable. Library: HTML/Tailwind.
        4. Report Info: Prevention Methods (from .pptx). Goal: Provide actionable steps. Viz/Method: Interactive Tabs (HTML/JS). Interaction: Click to reveal advice. Justification: Organizes text neatly, prevents overwhelming users. Library: HTML/Tailwind/JS.
        5. Report Info: Learning Reinforcement. Goal: Test understanding. Viz/Method: Interactive Quiz (HTML/JS). Interaction: Click, submit, get feedback. Justification: Active learning is more engaging. Library: HTML/Tailwind/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-neutral-700 hover:bg-neutral-100 hover:text-neutral-900;
        }
        .nav-link.active {
            @apply bg-blue-100 text-blue-700;
        }
        .tab-button {
            @apply px-4 py-2 font-semibold text-neutral-600 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-600;
        }
        .tab-button.active {
            @apply text-blue-600 border-blue-600;
        }
        .quiz-question.correct {
            @apply bg-green-100 border-green-400;
        }
        .quiz-question.incorrect {
            @apply bg-red-100 border-red-400;
        }
    </style>
</head>
<body class="bg-neutral-50 text-neutral-800">

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script>
    
        // 2. [⭐필수⭐] Firebase 콘솔에서 복사한 실제 설정 정보로 대체해야 합니다.
        const firebaseConfig = {
            apiKey: "AIzaSyASDJulH_VLREZGiZB0b_E3MO5dV11KOXI",
    authDomain: "metal-zodiac-471900-m1.firebaseapp.com",
    projectId: "metal-zodiac-471900-m1",
    storageBucket: "metal-zodiac-471900-m1.firebasestorage.app",
    messagingSenderId: "1028434025451",
    appId: "1:1028434025451:web:212df51dc4446f468fd7ae",
    measurementId: "G-9WSVS65B7G"
        };
// 3. Firebase 및 Firestore 초기화
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore("gcpdb-1");
</script>

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto max-w-6xl px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0">
                    <span class="text-xl font-bold text-blue-700">보안 교육 센터</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#home" class="nav-link">홈</a>
                        <a href="#what-is" class="nav-link">랜섬웨어란?</a>
                        <a href="#cases" class="nav-link">주요 사례</a>
                        <a href="#prevention" class="nav-link">예방 수칙</a>
                        <a href="#quiz" class="nav-link">보안 퀴즈</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-neutral-400 hover:text-white hover:bg-neutral-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div id="mobile-menu" class="md:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" class="nav-link block">홈</a>
                <a href="#what-is" class="nav-link block">랜섬웨어란?</a>
                <a href="#cases" class="nav-link block">주요 사례</a>
                <a href="#prevention" class="nav-link block">예방 수칙</a>
                <a href="#quiz" class="nav-link block">보안 퀴즈</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto max-w-6xl p-4 md:p-8">
        
        <section id="home" class="text-center bg-white p-8 md:p-12 rounded-lg shadow-lg mb-12 min-h-[60vh] flex flex-col justify-center items-center">
            <div class="max-w-3xl">
                <div class="mx-auto flex items-center justify-center h-24 w-24 rounded-full bg-red-100 mb-6">
                    <span class="text-6xl text-red-600">!</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold text-red-700 mb-4">랜섬웨어, 우리도 예외일 수 없습니다.</h1>
                <p class="text-xl text-neutral-700 mb-8">
                    단 한 번의 클릭이 회사의 막대한 손실로 이어질 수 있습니다. 본 교육 자료는 실제 발생했던 <strong class="font-semibold text-red-600">NVH USA 랜섬웨어 감염 사고</strong>와 글로벌 사례를 통해 우리가 무엇을 대비해야 하는지 알려줍니다.
                </P>
                <p class="text-lg text-neutral-600">
                    아래 섹션을 탐색하며 랜섬웨어의 위협을 인지하고, 우리의 소중한 데이터를 지키기 위한 필수 예방 수칙을 숙지하시기 바랍니다.
                </p>
            </div>
        </section>

        <section id="what-is" class="mb-12 p-8 bg-white rounded-lg shadow-md scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-8">1. 랜섬웨어(Ransomware)란 무엇인가요?</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-neutral-100 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold text-blue-700 mb-3">정의</h3>
                    <p>'몸값(Ransom)'과 '소프트웨어(Software)'의 합성어입니다. 해커가 피해자의 컴퓨터 시스템에 침투하여 중요 파일을 암호화한 뒤, 이를 해제(복호화)하는 조건으로 금전을 요구하는 악성 프로그램을 말합니다.</p>
                </div>
                <div class="bg-neutral-100 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold text-blue-700 mb-3">작동 방식</h3>
                    <p>주로 개인 PC에서 피싱 이메일, 악성 첨부파일, 신뢰할 수 없는 웹사이트 방문 등을 통해 감염됩니다. 한번 감염되면 네트워크를 통해 연결된 다른 서버나 PC로 빠르게 확산되어 주요 데이터를 암호화합니다.</p>
                </div>
            </div>
            <div class="mt-8 bg-red-100 border-l-4 border-red-500 text-red-700 p-6 rounded-md">
                <h3 class="text-xl font-semibold mb-3">EndPoint 랜섬웨어의 특징 (NVH USA 감염 사례)</h3>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>파일 암호화:</strong> 파일명 뒤에 <code class="bg-red-200 px-2 py-1 rounded">.endpoint</code> 확장자를 추가합니다.</li>
                    <li><strong>랜섬 노트:</strong> <code class="bg-red-200 px-2 py-1 rounded">'How to Restore Your Files.txt'</code> 와 같은 파일을 생성하여 몸값 지불을 유도합니다.</li>
                    <li><strong>복구 불확실성:</strong> <strong class="font-bold">몸값을 지불해도 데이터 복구를 보장하지 않습니다.</strong> 예방과 백업만이 최선의 전략입니다.</li>
                </ul>
            </div>
        </section>

        <section id="cases" class="mb-12 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-8">2. 주요 피해 사례</h2>
            <p class="text-center text-lg text-neutral-600 mb-6">실제 사례를 통해 랜섬웨어의 심각성을 확인해 보세요.</p>
            
            <div class="mb-6 border-b border-neutral-300">
                <nav class="flex justify-center -mb-px space-x-8" aria-label="Tabs">
                    <button class="tab-button active" onclick="showCaseTab('internal')">
                        내부 사례: NVH USA
                    </button>
                    <button class="tab-button" onclick="showCaseTab('external')">
                        글로벌 대형 사례
                    </button>
                </nav>
            </div>

            <div id="internal-case" class="case-tab-content">
                <div class="bg-white p-8 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-red-700 text-center mb-6">NVH USA 랜섬웨어 감염 사고 (2025년 10월)</h3>
                    <p class="text-center text-neutral-700 mb-8">우리에게도 실제로 일어난 일입니다. 당시의 주요 감염 원인은 다음과 같습니다.</p>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="border border-red-300 bg-red-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg text-red-800 mb-2">1. 계정 관리 미흡</h4>
                            <p class="text-red-700">전체 서버 6대의 ID와 PW를 동일하게 사용하여 하나의 계정이 탈취되자 모든 서버가 장악되었습니다.</p>
                        </div>
                        <div class="border border-red-300 bg-red-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg text-red-800 mb-2">2. 취약한 보안</h4>
                            <p class="text-red-700">집에서 개인 PC로 Wi-Fi를 통해 2차 인증(MFA) 없이 중요 서버에 접속하여 감염 경로를 제공했습니다.</p>
                        </div>
                        <div class="border border-red-300 bg-red-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg text-red-800 mb-2">3. 외부 접근</h4>
                            <p class="text-red-700">피싱 이메일 또는 악성 첨부파일을 통해 최초 감염이 시작된 것으로 강력히 추정됩니다.</p>
                        </div>
                        <div class="border border-red-300 bg-red-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg text-red-800 mb-2">4. 공장 PC 보안</h4>
                            <p class="text-red-700">보안에 취약할 수 있는 공장 단말기에서 인터넷 사용이 허용되어 위험에 노출되었습니다.</p>
                        </div>
                        <div class="border border-red-300 bg-red-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-lg text-red-800 mb-2">5. 모니터링 부재</h4>
                            <p class="text-red-700">침입 방지 및 로그 분석 시스템이 부재하여 의심스러운 경로를 사전에 파악하고 차단하지 못했습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="external-case" class="case-tab-content hidden">
                <div class="bg-white p-8 rounded-lg shadow-md">
                    <h3 class="text-2xl font-bold text-blue-700 text-center mb-6">전 세계를 강타한 랜섬웨어 공격</h3>
                    <p class="text-center text-neutral-700 mb-8">타사의 막대한 피해 규모를 통해 랜섬웨어의 파괴력을 확인해 보세요.</p>

                    <div class="mb-8 space-y-4">
                        <div class="border rounded-lg">
                            <button class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left" onclick="toggleAccordion(this)">
                                <span>1. 워너크라이 (WannaCry) - 2017년</span>
                                <span class="accordion-icon text-2xl font-light">+</span>
                            </button>
                            <div class="accordion-content hidden p-5 border-t bg-neutral-50">
                                <p class="mb-2"><strong>공격 개요:</strong> MS 윈도우 취약점을 이용해 전 세계 150여 개국 30만 대 이상의 컴퓨터를 감염시켰습니다. 특히 영국 국민보건서비스(NHS) 시스템이 마비되어 수술이 취소되는 등 큰 혼란을 야기했습니다.</p>
                                <p class="text-lg font-semibold"><strong>추정 피해액:</strong> <span class="text-red-600 text-2xl font-bold">약 40억 달러 (약 5조 5천억 원)</span></p>
                            </div>
                        </div>
                        <div class="border rounded-lg">
                            <button class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left" onclick="toggleAccordion(this)">
                                <span>2. 낫페트야 (NotPetya) - 2017년</span>
                                <span class="accordion-icon text-2xl font-light">+</span>
                            </button>
                            <div class="accordion-content hidden p-5 border-t bg-neutral-50">
                                <p class="mb-2"><strong>공격 개요:</strong> 단순 암호화를 넘어 하드 드라이브를 파괴하는 파괴적인 공격이었습니다. 세계 최대 해운사 '머스크(Maersk)'는 전체 시스템이 마비되어 막대한 손실을 입었습니다.</p>
                                <p class="text-lg font-semibold"><strong>추정 피해액:</strong> <span class="text-red-600 text-2xl font-bold">약 100억 달러 (약 13조 8천억 원)</span></p>
                            </div>
                        </div>
                        <div class="border rounded-lg">
                            <button class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left" onclick="toggleAccordion(this)">
                                <span>3. 콜로니얼 파이프라인 (Colonial Pipeline) - 2021년</span>
                                <span class="accordion-icon text-2xl font-light">+</span>
                            </button>
                            <div class="accordion-content hidden p-5 border-t bg-neutral-50">
                                <p class="mb-2"><strong>공격 개요:</strong> 미국 최대 송유관 운영사가 공격받아 동부 해안의 연료 공급이 중단되었습니다. 이로 인해 유가 급등과 사재기 등 사회적 혼란이 발생했으며, 결국 회사는 해커에게 몸값을 지불했습니다.</p>
                                <p class="text-lg font-semibold"><strong>지불한 몸값:</strong> <span class="text-red-600 text-2xl font-bold">약 440만 달러 (약 60억 원)</span></p>
                            </div>
                        </div>
                    </div>

                    <h4 class="text-xl font-semibold text-center mt-10 mb-4">주요 랜섬웨어 추정 피해액 비교</h4>
                    <div class="chart-container">
                        <canvas id="damageChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="prevention" class="mb-12 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-8">3. 우리는 어떻게 예방해야 하는가?</h2>
            <p class="text-center text-lg text-neutral-600 mb-6">보안은 '나'로부터 시작됩니다. 다음 수칙을 반드시 준수해 주세요.</p>
            
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="border-b border-neutral-200">
                    <nav class="flex -mb-px" aria-label="Tabs">
                        <button class="prevention-tab-button w-1/3 p-4 font-semibold text-center active" onclick="showPreventionTab('employee')">
                            임직원 행동 수칙
                        </button>
                        <button class="prevention-tab-button w-1/3 p-4 font-semibold text-center" onclick="showPreventionTab('system')">
                            시스템/계정 보안
                        </button>
                        <button class="prevention-tab-button w-1/3 p-4 font-semibold text-center" onclick="showPreventionTab('backup')">
                            데이터 백업
                        </button>
                    </nav>
                </div>

                <div id="employee-prevention" class="prevention-tab-content p-8">
                    <h3 class="text-2xl font-semibold text-blue-700 mb-6">가장 중요한 첫 번째 방어선: 바로 당신입니다!</h3>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="text-red-600 font-bold text-2xl mr-3">1.</span>
                            <div>
                                <h4 class="font-semibold text-lg">의심스러운 이메일 절대 금지</h4>
                                <p class="text-neutral-600">출처가 불분명한 이메일, 특히 '긴급', '경고', '송장' 등의 제목을 가진 메일은 절대 열어보지 마세요. 첨부파일 실행이나 링크 클릭은 절대 금물입니다.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-600 font-bold text-2xl mr-3">2.</span>
                            <div>
                                <h4 class="font-semibold text-lg">불법 소프트웨어 설치 금지</h4>
                                <p class="text-neutral-600">업무와 무관한 프로그램, 인증되지 않은 소프트웨어(S/W) 설치는 해커에게 문을 열어주는 것과 같습니다.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-600 font-bold text-2xl mr-3">3.</span>
                            <div>
                                <h4 class="font-semibold text-lg">공용 PC 사용 주의 및 즉시 신고</h4>
                                <p class="text-neutral-600">공용 PC에서는 민감한 정보 작업을 피하고, 조금이라도 감염이 의심되는 증상(파일 암호화, 랜섬 노트 발견) 발생 시 즉시 네트워크를 차단하고 ICT팀에 신고하세요.</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div id="system-prevention" class="prevention-tab-content p-8 hidden">
                    <h3 class="text-2xl font-semibold text-blue-700 mb-6">안전한 시스템, 강력한 계정 관리</h3>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="text-blue-600 font-bold text-2xl mr-3">1.</span>
                            <div>
                                <h4 class="font-semibold text-lg">최신 보안 업데이트 적용</h4>
                                <p class="text-neutral-600">OS(윈도우 등), 백신 프로그램, 업무용 S/W는 항상 최신 버전으로 업데이트하여 보안 취약점을 제거합니다.</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 font-bold text-2xl mr-3">2.</span>
                            <div>
                                <h4 class="font-semibold text-lg">강력한 비밀번호 사용 및 2차 인증(MFA)</h4>
                                <p class="text-neutral-600">추측하기 어려운 복잡한 비밀번호를 사용하고, 주기적으로 변경하세요. 특히 외부에서 접속하는 경우 <strong class="font-bold">반드시 2차 인증(MFA)을 사용</strong>해야 합니다. (NVH USA 사고의 핵심 원인!)</p>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 font-bold text-2xl mr-3">3.</span>
                            <div>
                                <h4 class="font-semibold text-lg">공유 폴더 권한 최소화</h4>
                                <p class="text-neutral-600">네트워크 공유 폴더는 필요한 사람에게만 최소한의 권한(읽기/쓰기)을 부여하여 랜섬웨어 확산 범위를 줄여야 합니다.</p>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div id="backup-prevention" class="prevention-tab-content p-8 hidden">
                    <h3 class="text-2xl font-semibold text-blue-700 mb-6">최후의 보루: 데이터 백업</h3>
                    <p class="mb-6 text-neutral-600">모든 방어가 뚫렸을 때 우리를 구해줄 유일한 방법은 '안전하게 분리된 백업' 뿐입니다.</p>
                    <h4 class="text-xl font-semibold mb-4 text-center">3-2-1 백업 원칙</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <h5 class="text-5xl font-bold text-blue-600 mb-2">3</h5>
                            <p class="font-semibold text-lg">개의 데이터 사본</p>
                            <p class="text-neutral-600">(원본 1개 + 사본 2개)</p>
                        </div>
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <h5 class="text-5xl font-bold text-blue-600 mb-2">2</h5>
                            <p class="font-semibold text-lg">가지 다른 저장 매체</p>
                            <p class="text-neutral-600">(예: 로컬 디스크 + 클라우드)</p>
                        </div>
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <h5 class="text-5xl font-bold text-blue-600 mb-2">1</h5>
                            <p class="font-semibold text-lg">개는 오프라인/외부 보관</p>
                            <p class="text-neutral-600">(랜섬웨어와 완전히 분리)</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="quiz" class="mb-12 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-8">4. 보안 지식 퀴즈</h2>
            <p class="text-center text-lg text-neutral-600 mb-6">학습한 내용을 바탕으로 간단한 퀴즈를 풀어보세요.</p>
            <div class="bg-white p-8 rounded-lg shadow-md max-w-3xl mx-auto">
                <form id="quizForm">
	<div class="mb-6 p-4 border rounded-lg bg-neutral-50">
                <p class="font-semibold text-lg mb-3 text-blue-700">정보 입력</p>
                <div class="space-y-3">
                    <div>
                        <label for="corpInput" class="block text-sm font-medium text-neutral-700 mb-1">법인 (예: NVH KOREA)</label>
                        <input type="text" id="corpInput" name="corp" required 
                               class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                               placeholder="필수 입력">
                    </div>
                    <div>
                        <label for="employeeIdInput" class="block text-sm font-medium text-neutral-700 mb-1">사번</label>
                        <input type="text" id="employeeIdInput" name="employeeId" required
                               class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                               placeholder="필수 입력">
                    </div>
                </div>
            </div>
                    <div id="q1" class="quiz-question mb-6 p-4 border rounded-lg">
                        <p class="font-semibold text-lg mb-3">Q1. 출처가 불분명하고 '긴급 송장'이라는 제목의 이메일을 받았습니다. 올바른 행동은?</p>
                        <div class="space-y-2">
                            <div><label class="font-normal"><input type="radio" name="q1" value="a" class="mr-2"> 즉시 첨부파일을 열어 송장을 확인한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q1" value="b" class="mr-2"> 동료에게 이메일을 전달하여 확인을 부탁한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q1" value="c" class="mr-2"> 이메일을 즉시 삭제하고 ICT팀에 신고한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q1" value="d" class="mr-2"> 답장을 보내 발신자가 누구인지 묻는다.</label></div>
                        </div>
                    </div>

                    <div id="q2" class="quiz-question mb-6 p-4 border rounded-lg">
                        <p class="font-semibold text-lg mb-3">Q2. NVH USA 랜섬웨어 사고의 주요 원인으로 <strong class="text-red-600">틀린</strong> 것은?</p>
                        <div class="space-y-2">
                            <div><label class="font-normal"><input type="radio" name="q2" value="a" class="mr-2"> 여러 서버에 동일한 ID와 비밀번호를 사용했다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q2" value="b" class="mr-2"> 2차 인증(MFA) 없이 외부에서 서버에 접속했다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q2" value="c" class="mr-2"> 백신 프로그램을 너무 최신 버전으로 유지했다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q2" value="d" class="mr-2"> 공장 단말기에서 인터넷 사용이 허용되어 있었다.</label></div>
                        </div>
                    </div>

                    <div id="q3" class="quiz-question mb-6 p-4 border rounded-lg">
                        <p class="font-semibold text-lg mb-3">Q3. 데이터 백업의 '3-2-1 원칙'에 대한 설명으로 올바른 것은?</p>
                        <div class="space-y-2">
                            <div><label class="font-normal"><input type="radio" name="q3" value="a" class="mr-2"> 3개의 사본을, 2개의 다른 매체에, 1개는 오프라인(외부)에 보관한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q3" value="b" class="mr-2"> 3일마다, 2번씩, 1개의 하드에 백업한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q3" value="c" class="mr-2"> 3개의 파일을, 2개의 폴더에, 1번만 백업한다.</label></div>
                            <div><label class="font-normal"><input type="radio" name="q3" value="d" class="mr-2"> 3명 이상이, 2개 이상의 PC에, 1일 1회 백업한다.</label></div>
                        </div>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition duration-300 text-lg">
                            결과 확인
                        </button>
                    </div>
                </form>
                <div id="quizResults" class="mt-6 text-center text-xl font-bold"></div>
            </div>
        </section>
    </main>

    <footer class="bg-neutral-800 text-neutral-300 text-center p-6 mt-12">
        <p>&copy; 2025 NBTS ICT 기획팀. 모두의 보안을 위해 항상 노력하겠습니다.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const damageData = {
                labels: ['워너크라이 (2017)', '낫페트야 (2017)', '콜로니얼 파이프라인 (2021)'],
                datasets: [
                    {
                        label: '추정 피해액 (단위: 억 달러)',
                        data: [40, 100, 0.044], 
                        backgroundColor: [
                            'rgba(220, 38, 38, 0.6)', 
                            'rgba(192, 0, 0, 0.6)',  
                            'rgba(239, 68, 68, 0.6)' 
                        ],
                        borderColor: [
                            'rgba(220, 38, 38, 1)',
                            'rgba(192, 0, 0, 1)',
                            'rgba(239, 68, 68, 1)'
                        ],
                        borderWidth: 1
                    }
                ]
            };
            
            const damageConfig = {
                type: 'bar',
                data: damageData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: false,
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        if (context.label === '콜로니얼 파이프라인 (2021)') {
                                            label += (context.parsed.y * 10000) + '만 달러 (몸값)';
                                        } else {
                                            label += context.parsed.y + '억 달러';
                                        }
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '피해액 (억 달러)'
                            }
                        }
                    }
                }
            };

            const damageChartCtx = document.getElementById('damageChart');
            if(damageChartCtx) {
                new Chart(damageChartCtx.getContext('2d'), damageConfig);
            }

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    mobileMenuButton.querySelector('svg.block').classList.toggle('hidden');
                    mobileMenuButton.querySelector('svg.hidden').classList.toggle('hidden');
                });
            }

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if(targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                    if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                        mobileMenuButton.querySelector('svg.block').classList.remove('hidden');
                        mobileMenuButton.querySelector('svg.hidden').classList.add('hidden');
                    }
                });
            });

	const corpInput = document.getElementById('corpInput');
            const employeeIdInput = document.getElementById('employeeIdInput');

            const quizForm = document.getElementById('quizForm');
            if (quizForm) {
                quizForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const answers = {
                        q1: 'c',
                        q2: 'c',
                        q3: 'a'
                    };
                    let score = 0;
                    const totalQuestions = Object.keys(answers).length;

                    const correctness = {};      // 문제별 정답 여부 (C1, C2, C3에 대응)
                    const submitted = {};        // 🎯 제출된 답안 (A1, A2, A3에 대응될 변수)

                    for (const q in answers) {
                        const questionDiv = document.getElementById(q);
                        questionDiv.classList.remove('correct', 'incorrect');
                        const selected = document.querySelector(`input[name="${q}"]:checked`);
                        
                        let isCorrect = false;

                        // 🎯 제출된 답안을 'submitted' 객체에 저장 (A1, A2, A3에 대응될 값)
                        submitted[q] = selected ? selected.value : null; 

                        if (selected && selected.value === answers[q]) {
                            score++;
                            isCorrect = true;
                            questionDiv.classList.add('correct');
                        } else {
                            questionDiv.classList.add('incorrect');
                        }
                        
                        // 문제별 정답 여부를 'correctness' 객체에 저장
                        correctness[q] = isCorrect;
                    }

                    const resultsDiv = document.getElementById('quizResults'); 
                    
                    // 🎯 Firestore에 저장할 데이터 객체 구성 (오류 수정 및 필드 재구성)
                    const resultData = {
                        // 사용자 입력 정보
                        corp: corpInput.value,           
                        employeeId: employeeIdInput.value, 

                        // 퀴즈 결과 정보
                        score: score,
                        total: totalQuestions,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        
                        // 🎯 C1, C2, C3 필드 (correctness 객체의 값 직접 참조)
                        C1: correctness.q1, 
                        C2: correctness.q2,
                        C3: correctness.q3,
                        
                        // 🎯 A1, A2, A3 필드 (submitted 객체의 값 직접 참조)
                        A1: submitted.q1,
                        A2: submitted.q2,
                        A3: submitted.q3,

                        // 상세 분석용 객체 (선택적)
                        correctness_detail: correctness,
                        answers_submitted_detail: submitted, 
                    };

                    // Firestore에 데이터 저장 실행
                    db.collection("exam_result_his").add(resultData)
			//db.collection("exam_result_his").doc("R_QUIZ_HIS").set(resultData)
                        .then(() => {
                            // 저장 성공 시 결과 표시
                            resultsDiv.textContent = `결과: ${totalQuestions}문제 중 ${score}문제 정답입니다! (결과 저장 완료 ✅)`;
                            resultsDiv.style.color = (score === totalQuestions) ? 'green' : 'red';
                            if(score === totalQuestions) {
                                resultsDiv.textContent += " 완벽합니다! 👏";
                            } else {
                                resultsDiv.textContent += " 틀린 문제를 다시 확인해 보세요.";
                            }
                        })
                        .catch((error) => {
                            // 저장 실패 시 오류 메시지 표시
                            console.error("Firestore 저장 실패: ", error);
                            resultsDiv.textContent = `결과 확인 실패: 데이터베이스 연결 또는 보안 규칙 오류 발생! (${error.message})`;
                            resultsDiv.style.color = 'red'; 
                        });
                });
            }
        });

        function showCaseTab(tabName) {
            document.querySelectorAll('.case-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            document.getElementById(tabName + '-case').classList.remove('hidden');

            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        function showPreventionTab(tabName) {
            document.querySelectorAll('.prevention-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            document.getElementById(tabName + '-prevention').classList.remove('hidden');

            document.querySelectorAll('.prevention-tab-button').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        function toggleAccordion(button) {
            const content = button.nextElementSibling;
            const icon = button.querySelector('.accordion-icon');
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) {
                icon.textContent = '+';
            } else {
                icon.textContent = '-';
            }
        }
    </script>
</body>
</html>
